local GM = GM or GAMEMODE

GM.MAP.KILLERS =
{
		[1] = {
		["name"] = "Jason Voorhees",
		["icon"] = "icons/icon_jason.png",
		["description"] = "class_desc_jason",
		["model"] = "models/player/mkx_jason.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 210"
		},
		[2] = {
		["name"] = "KAMENSHIK",
		["icon"] = "icons/xleb.png",
		["description"] = "class_desc_kamen",
		["model"] = "models/player/kamenshik.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 240",
		["joke"] = true
		},
		[3] = {
		["name"] = "Huntress",
		["icon"] = "icons/huntress.png",
		["description"] = "class_desc_huntress",
		["model"] = "models/players/mj_dbd_bear.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 240",
		},
		[4] = {
		["name"] = "Slenderman",
		["icon"] = "icons/slenderman.png",
		["description"] = "class_desc_slender",
		["model"] = "models/player/lordvipes/slenderman/slenderman_playermodel_cvp.mdl",
		["stats"] = "\nWalk Speed = 120\nRun Speed = 160",
		["map"] = "slash_summercamp",
		},
		[5] = {
		["name"] = "Michael Myers",
		["icon"] = "icons/icon_myers.png",
		["description"] = "class_desc_myers",
		["model"] = "models/player/dewobedil/mike_myers/default_p.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		},
		[6] = {
		["name"] = "the Proxy",
		["icon"] = "icons/icon_proxy.png",
		["description"] = "class_desc_proxy",
		["model"] = "models/slender_arrival/chaser.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		},
		[7] = {
		["name"] = "the Machine",
		["icon"] = "icons/springtrap.png",
		["description"] = "class_desc_springtrap",
		["model"] = "models/tetTris/FNaF/SB/Burntrap_inkmanspm.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		},
		[8] = {
		["name"] = "Albert Wesker",
		["icon"] = "icons/wesker.png",
		["description"] = "class_desc_wesker",
		["model"] = "Models/Player/slow/amberlyn/re5/wesker/slow.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		["map"] = "slash_subway",
		},
		[9] = {
		["name"] = "Scrake",
		["icon"] = "icons/scrake.png",
		["description"] = "class_desc_scrake",
		["model"] = "models/Splinks/KF2/zeds/Player_Scrake.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		},
		[10] = {
		["name"] = "T-800",
		["icon"] = "icons/t800.png",
		["description"] = "class_desc_t800",
		["model"] = "models/player/t-800/t800nw.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		},
		[11] = {
		["name"] = "Ghostface",
		["icon"] = "icons/icon_ghostface.png",
		["description"] = "class_desc_ghostface",
		["model"] = "models/player/cla/classic_ghostface.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 240",
		},
		[12] = {
		["name"] = "Cloaker",
		["icon"] = "icons/cloaker.png",
		["description"] = "class_desc_cloaker",
		["model"] = "models/mark2580/payday2/pd2_cloaker_zeal_player.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 240",
		["joke"] = true
		},
		[13] = {
		["name"] = "Specimen 8",
		["icon"] = "icons/spec8.png",
		["description"] = "class_desc_specimen8",
		["model"] = "models/violetqueen/sjsm/deerlord.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 190",
		},
		[14] = {
		["name"] = "Tirsiak",
		["icon"] = "icons/tirsiak.png",
		["description"] = "class_desc_uspecimen4",
		["model"] = "models/dreadhunger/player/hunter.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 210",
		},
		[15] = {
		["name"] = "Leo Kasper",
		["icon"] = "icons/kasper.png",
		["description"] = "class_desc_kasper",
		["model"] = "models/svotnik/Leo_Kasper/Leo_Kasper_PM.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 210",
		},
		[16] = {
		["name"] = "Metal Worker",
		["icon"] = "icons/metalworker.png",
		["description"] = "class_desc_metallyst",
		["model"] = "models/materials/humans/group03m/male_08.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 210",
		},
		[17] = {
		["name"] = "the Intruder",
		["icon"] = "icons/icon_intruder.png",
		["description"] = "class_desc_intruder",
		["model"] = "models/steinman/slashers/intruder_pm.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		},
		[18] = {
		["name"] = "the Impostor",
		["icon"] = "icons/amogus.png",
		["description"] = "class_desc_amogus",
		["model"] = "models/josephthekp/amongdrip.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		["joke"] = true
		},
		[19] = {
		["name"] = "White Face",
		["icon"] = "icons/whiteface.png",
		["description"] = "class_desc_whiteface",
		["model"] = "models/imscared/whiteface.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200\nRage Walk/Run Speed = 300",
		},
		[20] = {
		["name"] = "Norman Bates",
		["icon"] = "icons/icon_bates.png",
		["description"] = "class_desc_bates",
		["model"] = "models/steinman/slashers/bates_pm.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		},
		[21] = {
		["name"] = "Tadero the Necromancer",
		["icon"] = "icons/tadero.png",
		["description"] = "class_desc_tadero",
		["model"] = "models/players/an_cc_necromancer.mdl",
		["stats"] = "\nWalk Speed = 160\nRun Speed = 160",
		},
		[22] = {
		["name"] = "SCP-049",
		["icon"] = "icons/scp049.png",
		["description"] = "class_desc_scp049",
		["model"] = "models/lolozaure/scp49.mdl",
		["stats"] = "\nWalk Speed = 200\nRun Speed = 200",
		},
		[23] = {
		["name"] = "the Deerling",
		["icon"] = "icons/deerling.png",
		["description"] = "class_desc_deerling",
		["model"] = "models/bala/monsterboys_pm.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 240",
		},
		[24] = {
		["name"] = "Bacteria",
		["icon"] = "icons/bacteria.png",
		["description"] = "class_desc_bacteria",
		["model"] = "models/player/Bacteria.mdl",
		["stats"] = "\nWalk Speed = 190\nRun Speed = 220",
		},
		[25] = {
			["name"] = "Mute",
			["icon"] = "icons/mute.png",
			["description"] = "class_desc_mute",
			["model"] = "models/bellkiller_cw.mdl",
			["stats"] = "\nWalk Speed = 120\nRun Speed = 150",
		},
		[26] = {
			["name"] = "the Nightmare",
			["icon"] = "icons/nightmare.png",
			["description"] = "class_desc_nightmare",
			["model"] = "models/players/mj_dbd_fred.mdl",
			["stats"] = "\nWalk Speed = 190\nRun Speed = 220",
		},
}

if CLIENT then

	surface.CreateFont( "Roboto F4", {
		font = "Roboto Bold", --  Use the font-name which is shown to you by your operating system Font Viewer, not the file name
		extended = false,
		size = 20,
		weight = 500,
		blursize = 0,
		scanlines = 0,
		antialias = true,
		underline = false,
		italic = false,
		strikeout = false,
		symbol = false,
		rotary = false,
		shadow = false,
		additive = false,
		outline = false,
	} )

local sls_ply_choosen_killer_model
local sls_ply_choosen_killer_description
local sls_ply_choosen_killer_stats

function OpenHUBMENU()
	if IsValid(HUBMENU) then HUBMENU:Remove() end
HUBMENU = vgui.Create( "DFrame" )
HUBMENU:SetSize( ScrW(), ScrH() )
HUBMENU:SetTitle("")
--HUBMENU:Center()
HUBMENU:SetPos(ScrW()/2, 0)
HUBMENU:MakePopup()
HUBMENU:SetDraggable(false)
HUBMENU:ShowCloseButton(false)
HUBMENU:MoveTo(0, 0, 1, 0, -1 )    
HUBMENU.Think = function(me)
	if input.IsKeyDown(KEY_ESCAPE) then
		return me:Remove()
	end
end
surface.PlaySound("ui/buttonrollover.wav")

function HUBMENU:Paint( w, h )
Derma_DrawBackgroundBlur(self)
end

local sheet = vgui.Create( "DColumnSheet", HUBMENU )
--sheet:Dock( FILL )
sheet:SetSize(ScrW(), ScrH())

local hub_close = HUBMENU:Add("DImageButton")
hub_close:AlignRight(-10)
hub_close:SetImage( "icon16/cancel.png" )
hub_close:SetSize(ScrW() * 0.025, ScrH() * 0.044)
hub_close:SetKeepAspect(true)
hub_close.DoClick = function()
	surface.PlaySound("ui/buttonclickrelease.wav")
	HUBMENU:Remove()
end

sheet.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, w, h, Color( 52, 73, 94, 80 ) ) end

local sls_killer_Checkbox = HUBMENU:Add( "DCheckBoxLabel" ) -- Create the checkbox
	sls_killer_Checkbox:SetPos(0, ScrH() * 0.98)
	sls_killer_Checkbox:SetText(GM.LANG:GetString("hub_killer_checkbox"))					-- Set the text next to the box
	sls_killer_Checkbox:SetFont("ChatFont")
	sls_killer_Checkbox:SetValue( LocalPlayer():GetNWBool("sls_killer_choose", true) )						-- Initial value
	if !LocalPlayer():GetNWBool("sls_killer_choose", true) then
	sls_killer_Checkbox:SetAlpha(50)
	end
function sls_killer_Checkbox:OnChange( val )
		LocalPlayer():SetNWBool("sls_killer_choose", val)
		net.Start("sls_killer_choose_nw")
		net.WriteBool(val)
		net.SendToServer()
		surface.PlaySound("ui/buttonrollover.wav")
		if !val then
			sls_killer_Checkbox:AlphaTo(50, 0.2)
		else
			sls_killer_Checkbox:AlphaTo(255, 0.2)
		end
end
local Checkbox_w, Checkbox_h = sls_killer_Checkbox:GetChild(1):GetSize()
sls_killer_Checkbox.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, ScrW() * Checkbox_w * 1.16 / ScrW(), h, Color( 236, 240, 241, 80 ) ) end
sls_killer_Checkbox:SetIndent( 4 )
sls_killer_Checkbox:SetTextColor(Color(243, 156, 18, 255))
sls_killer_Checkbox:SizeToContents()						-- Make its size the same as the contents
local Checkbox_w2, Checkbox_h2 = sls_killer_Checkbox:GetSize()
sls_killer_Checkbox:SetSize(Checkbox_w2 + 12, Checkbox_h2)


local survshow = vgui.Create( "DPanel", sheet )
survshow:Dock(FILL)
survshow.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, w, h, Color( 44, 62, 80, self:GetAlpha() ) ) end 
local survshow_sheet = sheet:AddSheet( GM.LANG:GetString("hub_survivorshow"), survshow, "icon16/vcard.png" )
survshow_sheet.Button.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, w, h, Color( 22, 160, 133, self:GetAlpha() ) ) end
survshow_sheet.Button:SetSize(60, 60)
survshow_sheet.Button:SetContentAlignment(5)
survshow_sheet.Button:SetFontInternal("Roboto F4")
for _,v in ipairs(survshow_sheet.Button:GetChildren()) do
	v:Remove()
end
survshow_sheet.Button:SetAlpha(125)

local killerchoose = vgui.Create( "DPanel", sheet )
killerchoose:Dock(FILL)
killerchoose.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, w, h, Color( 44, 62, 80, self:GetAlpha() ) ) end 
local killerchoose_sheet = sheet:AddSheet( GM.LANG:GetString("hub_killerchoose"), killerchoose, "icon16/vcard_edit.png" )
killerchoose_sheet.Button.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, w, h, Color( 142, 68, 173, self:GetAlpha() ) ) end 
killerchoose_sheet.Button:SetSize(60, 60)
killerchoose_sheet.Button:SetContentAlignment(5)
killerchoose_sheet.Button:SetFontInternal("Roboto F4")
for _,v in ipairs(killerchoose_sheet.Button:GetChildren()) do
	v:Remove()
end

local descriptionpanel = vgui.Create( "DPanel", sheet )
descriptionpanel:Dock(FILL)
descriptionpanel.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, w, h, Color( 44, 62, 80, self:GetAlpha() ) ) end 
local descriptionpanel_sheet = sheet:AddSheet( GM.LANG:GetString("hub_description"), descriptionpanel, "icon16/page.png" )
descriptionpanel_sheet.Button.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, w, h, Color( 41, 128, 185, self:GetAlpha() ) ) end 
descriptionpanel_sheet.Button:SetSize(60, 60)
descriptionpanel_sheet.Button:SetContentAlignment(5)
descriptionpanel_sheet.Button:SetFontInternal("Roboto F4")
for _,v in ipairs(descriptionpanel_sheet.Button:GetChildren()) do
	v:Remove()
end

local description = descriptionpanel:Add("RichText")
description:Dock( FILL )

function description:PerformLayout()
	self:SetFontInternal( "Roboto F4" )
	self:SetBGColor( Color( 0, 16, 32 ) )
end

local modelpanel = vgui.Create( "DPanel", sheet )
modelpanel:Dock(FILL)
modelpanel.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, w, h, Color( 0, 128, 255, 0 ) ) end 
local modelpanel_sheet = sheet:AddSheet( GM.LANG:GetString("hub_model"), modelpanel, "icon16/user_gray.png" )
modelpanel_sheet.Button.Paint = function( self, w, h ) draw.RoundedBox( 16, 0, 0, w, h, Color( 127, 140, 141, self:GetAlpha() ) ) end 
modelpanel_sheet.Button:SetSize(60, 60)
modelpanel_sheet.Button:SetContentAlignment(5)
modelpanel_sheet.Button:SetFontInternal("Roboto F4")
for _,v in ipairs(modelpanel_sheet.Button:GetChildren()) do
	v:Remove()
end

survshow_sheet.Button.DoClick = function()
	local btn = survshow_sheet.Button
	btn:AlphaTo(125, 0.6)
	killerchoose_sheet.Button:AlphaTo(255, 0.2)
	descriptionpanel_sheet.Button:AlphaTo(255, 0.2)
	modelpanel_sheet.Button:AlphaTo(255, 0.2)
	sheet:SetActiveButton(survshow_sheet.Button)
	surface.PlaySound("ui/buttonclick.wav")
end

killerchoose_sheet.Button.DoClick = function()
	local btn = killerchoose_sheet.Button
	survshow_sheet.Button:AlphaTo(255, 0.2)
	descriptionpanel_sheet.Button:AlphaTo(255, 0.2)
	modelpanel_sheet.Button:AlphaTo(255, 0.2)
	btn:AlphaTo(125, 0.6)
	sheet:SetActiveButton(killerchoose_sheet.Button)
	surface.PlaySound("ui/buttonclick.wav")
end

descriptionpanel_sheet.Button.DoClick = function()
	local btn = descriptionpanel_sheet.Button
	btn:AlphaTo(125, 0.6)
	survshow_sheet.Button:AlphaTo(255, 0.2)
	killerchoose_sheet.Button:AlphaTo(255, 0.2)
	modelpanel_sheet.Button:AlphaTo(255, 0.2)
	sheet:SetActiveButton(descriptionpanel_sheet.Button)
	surface.PlaySound("ui/buttonclick.wav")
end

modelpanel_sheet.Button.DoClick = function()
	local btn = modelpanel_sheet.Button
	btn:AlphaTo(125, 0.6)
	survshow_sheet.Button:AlphaTo(255, 0.1)
	killerchoose_sheet.Button:AlphaTo(255, 0.1)
	descriptionpanel_sheet.Button:AlphaTo(255, 0.2)
	sheet:SetActiveButton(modelpanel_sheet.Button)
	surface.PlaySound("ui/buttonclick.wav")
end

HUBMENUSSURVCROLL = vgui.Create("DScrollPanel", survshow)
HUBMENUSSURVCROLL:Dock( FILL )

local List2 = HUBMENUSSURVCROLL:Add( "DIconLayout" )
List2:Dock( FILL )
List2:SetSpaceY( 5 )
List2:SetSpaceX( 5 )

for num, survivor in ipairs(GM.CLASS.Survivors) do
local DermaImageButton2 = List2:Add( "DImageButton" )
local survnameimage = DermaImageButton2:Add("DLabel")
survnameimage:SetFont("Roboto F4")
survnameimage:SetText(survivor["dispname"])
survnameimage:SetTextColor(Color(255, 255, 255, 45))
survnameimage:Dock(BOTTOM)
survnameimage:SetWrap(true)
survnameimage:SetAutoStretchVertical( true )
survnameimage:SizeToContents()

DermaImageButton2:SetMaterial(survivor["icon"])
DermaImageButton2:SetSize(116, 116)
DermaImageButton2.DoClick = function()
	surface.PlaySound("ui/buttonclickrelease.wav")
	if istable(ULib) and ply:query("sls_setsurv") then
	net.Start("sls_survivor_choose_admin")
	net.WriteInt(num, 6)
	net.SendToServer()
	end
if (string.find(GM.LANG:GetString(survivor["description"]), "Unknow")) then
description:SetText(survivor["description"])
description:AppendText("\nHP = " .. survivor["life"] .. "\n" .. "Walk Speed = " .. survivor["walkspeed"] .. "\n" .. "Run Speed = " .. survivor["runspeed"] .. "\n" .. "Stamina = " .. survivor["stamina"])
else
description:SetText(GM.LANG:GetString(survivor["description"]))
description:AppendText("\nHP = " .. survivor["life"] .. "\n" .. "Walk Speed = " .. survivor["walkspeed"] .. "\n" .. "Run Speed = " .. survivor["runspeed"] .. "\n" .. "Stamina = " .. survivor["stamina"])
end
if IsValid(sls_playermodel) then sls_playermodel:Remove() end
sls_playermodel = modelpanel:Add( "DAdjustableModelPanel" )
sls_playermodel:Dock(FILL)
function sls_playermodel:LayoutEntity( Entity ) return end -- disables default rotation

local clickonme_mdl = sls_playermodel:Add("DLabel")
clickonme_mdl:Dock(TOP)
clickonme_mdl:SetFont("GModNotify")
clickonme_mdl:SetText("Click to show model")
clickonme_mdl:SetTextColor(Color(255, 200, 0, 50))
clickonme_mdl:SetContentAlignment(8)
clickonme_mdl:SizeToContents()

sls_playermodel:SetModel(survivor["model"] )

local headpos = sls_playermodel.Entity:GetBonePosition(sls_playermodel.Entity:LookupBone("ValveBiped.Bip01_Head1"))
sls_playermodel:SetLookAt(headpos)

sls_playermodel:SetCamPos(headpos-Vector(-15, 0, 0))	-- Move cam in front of face

sls_playermodel.Entity:SetEyeTarget(headpos-Vector(-15, 0, 0))
end
end

HUBMENUSCROLL = vgui.Create("DScrollPanel", killerchoose)
HUBMENUSCROLL:Dock( FILL )

local List = HUBMENUSCROLL:Add( "DIconLayout" )
List:Dock( FILL )
List:SetSpaceY( 5 )
List:SetSpaceX( 5 )

local sls_killer_random_button = List:Add( "DImageButton" )
local sls_killer_random_button_name = sls_killer_random_button:Add("DLabel")
sls_killer_random_button_name:Dock(BOTTOM)
sls_killer_random_button_name:SetText(GM.LANG:GetString("hub_killer_random"))
sls_killer_random_button_name:SetFont("Roboto F4")
sls_killer_random_button_name:SetTextColor(Color(255, 255, 255, 45))
sls_killer_random_button_name:SizeToContents()
sls_killer_random_button_name:SetWrap(true)
sls_killer_random_button_name:SetAutoStretchVertical( true )
sls_killer_random_button:SetImage("icons/no_icon_red.png")
sls_killer_random_button:SetSize(116, 116)
sls_killer_random_button.DoClick = function()
	surface.PlaySound("ui/buttonclickrelease.wav")
	local rnd_killer
	for number, killer in RandomPairs(GM.MAP.KILLERS) do
		if (killer.map) and killer.map != game.GetMap() then continue end
		if (killer.joke) and GetConVar("slashers_unserious_killers"):GetInt() == 0 and killer.joke == true then continue end
		rnd_killer = number
		net.Start("sls_hub_choosekiller")
		net.WriteInt(rnd_killer, 6)
		net.SendToServer()
	if (string.find(GM.LANG:GetString(killer["description"]), "Unknow")) then
		description:SetText(killer["description"])
		description:AppendText(killer["stats"])
		sls_ply_choosen_killer_description = killer["description"]
		sls_ply_choosen_killer_stats = killer["stats"]
		else
		description:SetText(GM.LANG:GetString(killer["description"]))
		description:AppendText(killer["stats"])
		sls_ply_choosen_killer_description = GM.LANG:GetString(killer["description"])
		sls_ply_choosen_killer_stats = killer["stats"]
		end
		if IsValid(sls_playermodel) then sls_playermodel:Remove() end
		sls_playermodel = modelpanel:Add( "DAdjustableModelPanel" )
		local clickonme_mdl = sls_playermodel:Add("DLabel")
		clickonme_mdl:Dock(TOP)
		clickonme_mdl:SetFont("GModNotify")
		clickonme_mdl:SetText("Click to show model")
		clickonme_mdl:SetTextColor(Color(255, 200, 0, 50))
		clickonme_mdl:SetContentAlignment(8)
		clickonme_mdl:SizeToContents()
		sls_playermodel:Dock(FILL)
		function sls_playermodel:LayoutEntity( Entity ) return end -- disables default rotation
		sls_playermodel:SetModel(killer["model"])
		
		if (sls_playermodel.Entity:LookupBone("ValveBiped.Bip01_Head1")) then
		local headpos = sls_playermodel.Entity:GetBonePosition(sls_playermodel.Entity:LookupBone("ValveBiped.Bip01_Head1"))
		sls_playermodel:SetLookAt(headpos)
		
		sls_playermodel:SetCamPos(headpos-Vector(-15, 0, 0))	-- Move cam in front of face
		
		sls_playermodel.Entity:SetEyeTarget(headpos-Vector(-15, 0, 0))
		end
		
		sls_ply_choosen_killer_model = killer["model"]
	end
end

--if (GM.MAP.KILLERS[game.GetMap()]) then
for k, killer in pairs(GM.MAP.KILLERS) do --pairs(GM.MAP.KILLERS[game.GetMap()]) do
	if (killer.map) and killer.map != game.GetMap() then continue end

local DermaImageButton = List:Add( "DImageButton" )
local killername = DermaImageButton:Add("DLabel")
killername:Dock(BOTTOM)
killername:SetFont("Roboto F4")
killername:SetText(killer["name"])
killername:SetTextColor(Color(255, 255, 255, 45))
killername:SizeToContents()
killername:SetWrap(true)
killername:SetAutoStretchVertical( true )
DermaImageButton:SetImage(killer["icon"])
DermaImageButton:SetSize(116, 116)

if (sls_ply_choosen_killer_model) and (sls_ply_choosen_killer_description) and (sls_ply_choosen_killer_stats) then
description:SetText(sls_ply_choosen_killer_description)
description:AppendText(sls_ply_choosen_killer_stats)
if IsValid(sls_playermodel) then sls_playermodel:Remove() end
sls_playermodel = modelpanel:Add( "DAdjustableModelPanel" )
sls_playermodel:Dock(FILL)
function sls_playermodel:LayoutEntity( Entity ) return end -- disables default rotation
sls_playermodel:SetModel(sls_ply_choosen_killer_model)

if (sls_playermodel.Entity:LookupBone("ValveBiped.Bip01_Head1")) then
local headpos = sls_playermodel.Entity:GetBonePosition(sls_playermodel.Entity:LookupBone("ValveBiped.Bip01_Head1"))
sls_playermodel:SetLookAt(headpos)

sls_playermodel:SetCamPos(headpos-Vector(-15, 0, 0))	-- Move cam in front of face

sls_playermodel.Entity:SetEyeTarget(headpos-Vector(-15, 0, 0))
end

local clickonme_mdl = sls_playermodel:Add("DLabel")
clickonme_mdl:Dock(TOP)
clickonme_mdl:SetFont("GModNotify")
clickonme_mdl:SetText("Click to show model")
clickonme_mdl:SetTextColor(Color(255, 200, 0, 50))
clickonme_mdl:SetContentAlignment(8)
clickonme_mdl:SizeToContents()
end

DermaImageButton.DoClick = function()
	surface.PlaySound("ui/buttonclickrelease.wav")
net.Start("sls_hub_choosekiller")
net.WriteInt(k, 6)
net.SendToServer()
if (string.find(GM.LANG:GetString(killer["description"]), "Unknow")) then
description:SetText(killer["description"])
description:AppendText(killer["stats"])
sls_ply_choosen_killer_description = killer["description"]
sls_ply_choosen_killer_stats = killer["stats"]
else
description:SetText(GM.LANG:GetString(killer["description"]))
description:AppendText(killer["stats"])
sls_ply_choosen_killer_description = GM.LANG:GetString(killer["description"])
sls_ply_choosen_killer_stats = killer["stats"]
end
if IsValid(sls_playermodel) then sls_playermodel:Remove() end
sls_playermodel = modelpanel:Add( "DAdjustableModelPanel" )
local clickonme_mdl = sls_playermodel:Add("DLabel")
clickonme_mdl:Dock(TOP)
clickonme_mdl:SetFont("GModNotify")
clickonme_mdl:SetText("Click to show model")
clickonme_mdl:SetTextColor(Color(255, 200, 0, 50))
clickonme_mdl:SetContentAlignment(8)
clickonme_mdl:SizeToContents()
sls_playermodel:Dock(FILL)
function sls_playermodel:LayoutEntity( Entity ) return end -- disables default rotation
sls_playermodel:SetModel(killer["model"])

if (sls_playermodel.Entity:LookupBone("ValveBiped.Bip01_Head1")) then
local headpos = sls_playermodel.Entity:GetBonePosition(sls_playermodel.Entity:LookupBone("ValveBiped.Bip01_Head1"))
sls_playermodel:SetLookAt(headpos)

sls_playermodel:SetCamPos(headpos-Vector(-15, 0, 0))	-- Move cam in front of face

sls_playermodel.Entity:SetEyeTarget(headpos-Vector(-15, 0, 0))
end

sls_ply_choosen_killer_model = killer["model"]
end
end
end
end
net.Receive("sls_OpenHUB", OpenHUBMENU)

--end

if SERVER then
util.AddNetworkString("sls_OpenHUB")
util.AddNetworkString("sls_hub_choosekiller")
util.AddNetworkString("sls_killer_choose_nw")
util.AddNetworkString("sls_survivor_choose_admin")

hook.Add("ShowSpare2", "sls_hub_ShowSpare2", function(ply)
net.Start("sls_OpenHUB")
net.Send(ply)
end)

net.Receive("sls_hub_choosekiller", function(len, ply)
	ply:SetNWInt("choosen_killer", net.ReadInt(6))
end)

net.Receive("sls_survivor_choose_admin", function(len, ply)
	if istable(ULib) and ply:query("sls_setsurv") then
	ply:SetSurvClass(net.ReadInt(6))
	end
end)

net.Receive("sls_killer_choose_nw", function(len, ply)
ply:SetNWBool("sls_killer_choose", net.ReadBool())
end)

end